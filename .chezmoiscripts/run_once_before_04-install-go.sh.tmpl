{{- if eq .chezmoi.os "linux" -}}
#!/bin/bash
set -euo pipefail

GO_VERSION="1.22.5"

if ! command -v go &> /dev/null; then
    echo "Installing Go ${GO_VERSION}..."
    cd /tmp

    {{- if eq .chezmoi.arch "arm64" }}
    wget -q "https://go.dev/dl/go${GO_VERSION}.linux-arm64.tar.gz"
    sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf "go${GO_VERSION}.linux-arm64.tar.gz"
    rm -f "go${GO_VERSION}.linux-arm64.tar.gz"
    {{- else }}
    wget -q "https://go.dev/dl/go${GO_VERSION}.linux-amd64.tar.gz"
    sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf "go${GO_VERSION}.linux-amd64.tar.gz"
    rm -f "go${GO_VERSION}.linux-amd64.tar.gz"
    {{- end }}

    echo "Installing golangci-lint..."
    curl -sSfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh | sh -s v1.59.1
else
    echo "Go already installed, skipping..."
fi
{{- end }}
